/**
* Stacktodo JavaScript API. Version 0.0.2.
* https://github.com/stacktodo/stacktodo_js_api
* MIT License
*/
!function(t){var e=function(){var t=this;t.get=function(t){t={url:t.url||window.location.href,success:t.success||function(){},failure:t.failure||function(){},complete:t.complete||function(){}};var e;return"undefined"!=typeof XDomainRequest?(e=new XDomainRequest,e.open("GET",t.url)):(e=new XMLHttpRequest,e.open("GET",t.url,!0)),e.onload=function(){e.status>=200&&e.status<=299?t.success(e.responseText,e.status,e):t.failure(e.status,e.responseText,e),t.complete()},e.onerror=function(){t.failure(e.status,void 0,e),t.complete()},e.send(),e}};t.stacktodo=t.stacktodo||{},t.stacktodo.core=t.stacktodo.core||{},t.stacktodo.core.ajax=new e}(window),function(t){var e=function(){var t=this;return t.serialize=function(t){for(var e={},n={input:t.getElementsByTagName("input"),textarea:t.getElementsByTagName("textarea"),select:t.getElementsByTagName("select")},o=0;o<n.input.length;o++){var r=n.input[o].name;if(void 0!==r&&0!==r.length){var i=n.input[o].type;"checkbox"===i?n.input[o].checked&&(e[r]=e[r]||[],e[r].push(n.input[o].value)):"radio"===i?n.input[o].checked&&(e[r]=e[n.input[o].value]):(e[r]=e[r]||[],e[r].push(n.input[o].value))}}for(var a=0;a<n.textarea.length;a++){var r=n.textarea[a].name;void 0!==r&&0!==r.length&&(e[r]=e[r]||[],e[r].push(n.textarea[a].value))}for(var u=0;o<n.select.length;u++){var r=n.select[u].name;if(void 0!==r&&0!==r.length)for(var s=n.select[u].getElementsByTagName("option"),c=0;c<s.length;c++)if(s[c].selected){e[r]=e[r]||[],e[r].push(s[c].value);break}}for(var l in e)1===e[l].length&&(e[l]=e[l][0]);return e},t};t.stacktodo=t.stacktodo||{},t.stacktodo.core=t.stacktodo.core||{},t.stacktodo.core.form=new e}(window),function(t){var e=function(){var t=this,e="withCredentials"in new XMLHttpRequest||"undefined"!=typeof XDomainRequest,n=function(t){var e=[];for(var n in t)e.push(encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e.join("&")};return t.requestCORS=function(t,e,n,o,r){e=e.toUpperCase();var i;return"undefined"!=typeof XDomainRequest?(i=new XDomainRequest,i.open(e,t)):(i=new XMLHttpRequest,i.open(e,t,!0)),i.onload=function(){var t;try{t=JSON.parse(i.responseText)}catch(e){}var n=t&&void 0!==t.http_status?t.http_status:i.status;n>=200&&299>=n?o(t,n,i):r(i.status,t?t.error:void 0,i)},i.onerror=function(){r(i.status,void 0,i)},"POST"===e?(i.setRequestHeader("Content-type","application/json"),i.send(JSON.stringify(n))):i.send(),i},t.requestJSONP=function(t,e,o,r,i){e=e.toUpperCase();var a=document.createElement("script");a.type="text/javascript";var u="__jsonp_"+Math.ceil(1e4*Math.random()),s={jsonp:!0,id:u,response:void 0};window[u]=function(t){a.parentElement.removeChild(a),delete window[u],s.response=t,void 0===t||null===t?r(void 0,200,s):t.http_status>=200&&t.http_status<=299?r(t,t.http_status,s):i(t.http_status,t.error,s)},a.onerror=function(){a.parentElement.removeChild(a),s.jsonp_transport_error="ScriptErrorFailure",i(0,void 0,s)};var c;return c="POST"===e?"?"+n(o)+"&callback="+u+"&_="+(new Date).getTime():"?callback="+u+"&_="+(new Date).getTime(),a.src=t+c,document.head.appendChild(a),s},t.get=function(n){var o=e?"requestCORS":"requestJSONP";return t[o](n.url||window.location.href,"GET",void 0,function(t,e,o){n.success&&n.success(t,e,o),n.complete&&n.complete()},function(t,e,o){n.failure&&n.failure(t,e,o),n.complete&&n.complete()})},t.post=function(n){var o=e?"requestCORS":"requestJSONP";return t[o](n.url||window.location.href,"POST",n.payload||{},function(t,e,o){n.success&&n.success(t,e,o),n.complete&&n.complete()},function(t,e,o){n.failure&&n.failure(t,e,o),n.complete&&n.complete()})},t};t.stacktodo=t.stacktodo||{},t.stacktodo.core=t.stacktodo.core||{},t.stacktodo.core.jsoncors=new e}(window),function(t){var e=function(e){var n=this;return n.ERRORS={EmptyFormError:"EmptyFormError",UnknownFormError:"UnknownFormError",UnknownError:"UnknownError"},n.HUMANIZED_ERRORS={EmptyFormError:"Looks like you forgot to complete the form. Can you check it and try again?",UnknownFormError:"We couldn't find the form channel you're trying to send to :-(",UnknownError:"Something went wrong and we're not quite sure what. We'll look into it as soon as possible!"},n.humanizeError=function(t){return n.HUMANIZED_ERRORS[t]||n.HUMANIZED_ERRORS.UNKNOWN_ERROR},n.preValidate=function(t){for(var e in t)return null;return n.ERRORS.EmptyFormError},n.submit=function(o,r,i,a){r=r||function(){},i=i||function(){},a=a||function(){};var u=t.stacktodo.core.form.serialize(o),s=n.preValidate(o);null===s?t.stacktodo.core.jsoncors.post({url:"https://stacktodo.com/api/tool/form/submit",payload:{id:e,form:u},success:function(t,e,n){r(),a()},failure:function(t,e,o){if(!e)switch(t){case 404:e=n.ERRORS.UnknownFormError;break;default:e=n.ERRORS.UnknownError}i(e),a()}}):(i(s),a())},this};t.stacktodo=t.stacktodo||{},t.stacktodo.SlackForm=e}(window),function(t){var e=function(e){var n=this;n.ERRORS={MissingEmailError:"MissingEmailError",InvalidEmailError:"InvalidEmailError",UnknownTeamError:"UnknownTeamError",UnknownError:"UnknownError"},n.STATUSES={RequestedAuthState:"RequestedAuthState",InvitedUserState:"InvitedUserState"},n.HUMANIZED_ERRORS={MissingEmailError:"Your email is looking awfully blank, if you fill it in we can get you started",InvalidEmailError:"Your email doesn't quite look right. Can you check it and try again?",UnknownTeamError:"We couldn't find the team you're trying to join :-(",UnknownError:"Something went wrong and we're not quite sure what. We'll look into it as soon as possible!"},n.HUMANIZED_STATUSES={RequestedAuthState:"Awesome your email address has been sent for approval. You should receive an invitation email from slack once you've been approved",InvitedUserState:"Awesome you've been invited into the team. Check your inbox for the invitation email from slack!"},n.humanizeError=function(t){return n.HUMANIZED_ERRORS[t]||n.HUMANIZED_ERRORS.UNKNOWN_ERROR},n.humanizeStatus=function(t){return n.HUMANIZED_STATUSES[t]||n.HUMANIZED_ERRORS.UNKNOWN_ERROR},n.preValidate=function(t){return t&&0!==t.length?-1===t.indexOf("@")||t.length<7?n.ERRORS.InvalidEmailError:null:n.ERRORS.MissingEmailError};var o=function(t,e){for(var n in e)t[n]=e[n];return t};return n.join=function(r,i,a,u,s){a=a||function(){},u=u||function(){},s=s||function(){};var c=n.preValidate(r);null===c?t.stacktodo.core.jsoncors.post({url:"https://stacktodo.com/api/tool/invite/join",payload:o(i,{email:r,team:e}),success:function(t,e,n){a(t.state),s()},failure:function(t,e,o){if(!e)switch(t){case 404:e=n.ERRORS.UnknownTeamError;break;default:e=n.ERRORS.UnknownError}u(e),s()}}):(u(c),s())},n};t.stacktodo=t.stacktodo||{},t.stacktodo.SlackInvite=e}(window),function(t){var e=function(){var e=this,n=function(t){switch(t.length){case 1:return"?id="+encodeURIComponent(t[0]);case 2:return"?team="+encodeURIComponent(t[0])+"&reference="+encodeURIComponent(t[1]);default:throw"InitializationError : Incorrect params"}}(Array.prototype.slice.call(arguments)),o=null,r={};return e.loaded=function(){return null!==o},e.count=function(){return null===o?void 0:o.length},e.postHeadForId=function(t){for(var e=0;e<(o||[]).length;e++)if(o[e].id===t)return o[e];return void 0},e.postHeadForIndex=function(t){return null===o?void 0:o[i]},e.isPostIdLast=function(t){return null===o?!1:0===o.length?!1:o[o.length-1].id===t},e.nextPostHeadsForRange=function(t,n){if(null===o)return void 0;var r=0;if(t)for(var i=0;i<o.length;i++)if(o[i].id===t){r=i+1;break}r=Math.min(Math.max(0,r),e.count());for(var a=Math.min(Math.max(0,r+n),e.count()),u=[],i=r;a>i;i++)u.push(o[i]);return u},e.load=function(r,i){return t.stacktodo.core.jsoncors.get({url:"https://stacktodo.com/api/tool/publish/posts"+n,success:function(t,e,n){o=t.posts;for(var i=0;i<o.length;i++)o[i].index=i;r&&r()},failure:function(t,e,n){i&&i(t,e)}}),e},e.postForIndex=function(t,n,o){var r=e.postHeadForIndex(t);return e.postForId((r||{}).id,n,o)},e.postForId=function(n,o,i){if(o=o||function(){},i=i||function(){},r[n])setTimeout(function(){o(r[n])},1);else{var a=e.postHeadForId(n);void 0===a?setTimeout(function(){i(-1,"IndexNotLoadedError")}):t.stacktodo.core.ajax.get({url:a.url+"?ts="+(new Date).getTime(),success:function(t,e,u){try{t=JSON.parse(t)}catch(s){return void i(-1,"JSONParseError")}t.html=t.html.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,""),t.id=a.id,t.url=a.url,t.index=a.index,r[n]=t,o(t)},failure:function(t,e,n){i(t,e)}})}return e},e.postset=function(t,n,o,r){o=o||function(){},r=r||function(){};var i=e.nextPostHeadsForRange(t,n);if(void 0===i)setTimeout(function(){r(-1,"IndexNotLoadedError")});else if(0===i.length)setTimeout(function(){o({})});else{for(var a=!1,u={},s=0;s<i.length;s++)u[i[s].id]=null;for(var s=0;s<i.length;s++)!function(t,n){e.postForId(t,function(e){if(!a){u[t]=e;for(var n in u)if(null===u[n])return;o(u)}},function(t,e){a||(a=!0,r(t,e))})}(i[s].id,i[s].url)}return e},e.invalidatePost=function(t){return delete r[t],e},e.invalidatePosts=function(){return r={},e},e.invalidateIndex=function(){return o=null,e},e};t.stacktodo=t.stacktodo||{},t.stacktodo.SlackPublish=e}(window);